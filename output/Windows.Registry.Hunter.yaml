
name: Windows.Registry.Hunter
description: |
   This artifact parses and categorizes information for the registry.

   ## Remapping Strategy

   The artifact works by deploying search rules against the registry.
   A rule searches for a specific piece of data

   1. SAM is mapped to /SAM/
   2. NTUser.dat is mapped to HKEY_USERS/*
   3. System and Software hives are mappeed to HKEY_LOCAL_MACHINE and CurrentControlSet

parameters:
- name: CategoryFilter
  type: regex
  default: .
- name: CategoryExcludedFilter
  type: regex
  default: XXXXXX
- name: DescriptionFilter
  type: regex
  default: .
- name: RootFilter
  type: regex
  default: .
- name: RemappingStrategy
  description:
  type: choices
  default: "API And NTUser.dat"
  choices:
   - API
   - API And NTUser.dat
   - Raw Hives

- name: NTFS_CACHE_TIME
  type: int
  description: How often to flush the NTFS cache. (Default is never).
  default: "1000000"


imports:
  - Windows.Registry.NTUser

export: |
    // Map raw hives for hives that are not normally accessible via API
    LET _unmounted_hive_mapping = (
      _map_file_to_reg_path(
          HivePath="C:/Windows/System32/Config/SAM",
          RegistryPath="SAM",
          RegMountPoint="/",
          Accessor="auto",
          Description="Map SAM to /SAM/"),
      _map_file_to_reg_path(
          HivePath="C:/Windows/appcompat/Programs/Amcache.hve",
          RegistryPath="Amcache",
          RegMountPoint="/",
          Accessor="auto",
          Description="Map Amcache to /Amcache/"),
    ) + _required_mappings

    LET _api_remapping <= (
      dict(type="mount",
        `from`=dict(accessor="registry", prefix='/', path_type='registry'),
       on=dict(accessor="registry", prefix='/', path_type="registry")),
    )

    -- In API mode we sometimes can not access the keys due to permissions.
    -- We also map the raw hives to the raw_registry accessor to ensure
    -- that we can access protected keys.
    LET _raw_hive_mapping_for_api <= (
      dict(type="mount",
        `from`=dict(accessor="raw_reg",
         prefix=pathspec(Path='/',
           DelegatePath="C:/Windows/System32/Config/SYSTEM",
           DelegateAccessor="ntfs"),
         path_type='registry'),
       on=dict(accessor="raw_registry",
               prefix='/HKEY_LOCAL_MACHINE/System',
               path_type="registry")),
      dict(type="mount",
        `from`=dict(accessor="raw_reg",
         prefix=pathspec(Path='/',
           DelegatePath="C:/Windows/System32/Config/SOFTWARE",
           DelegateAccessor="ntfs"),
         path_type='registry'),
       on=dict(accessor="raw_registry",
               prefix='/HKEY_LOCAL_MACHINE/Software',
               path_type="registry")),
    )

    // The BCD hive is normally located on an unmounted drive so we
    // always map it with the API
    LET _bcd_map <= (dict(
       type="mount",
       `from`=dict(accessor="registry", prefix='HKEY_LOCAL_MACHINE\\BCD00000000', path_type='registry'),
       on=dict(accessor="registry", prefix='HKEY_LOCAL_MACHINE\\BCD00000000', path_type="registry")))

    // Apply the mappings:
    LET RemapRules = if(condition=RemappingStrategy = "API",
       then=_api_remapping +
            _unmounted_hive_mapping +
            _raw_hive_mapping_for_api,

    else=if(condition=RemappingStrategy = "API And NTUser.dat",
       then=_api_remapping +
            _user_mappings +
            _unmounted_hive_mapping +
            _raw_hive_mapping_for_api,

    else=_user_mappings +
         _unmounted_hive_mapping +
         _standard_mappings +
         _bcd_map))

    LET FetchKeyValues(OSPath) = to_dict(item={
      SELECT Name AS _key, Data.value AS _value
      FROM glob(globs="*", accessor="registry", root=OSPath)
    })
    
    LET GetDateFrom128Bit(x) = parse_binary(accessor="data",
      filename=x, profile='''
      [["X", 0, [
         ["year", 0, "uint16"],
         ["month", 2, "uint16"],
         ["day", 6, "uint16"],
         ["hour", 8, "uint16"],
         ["minute", 10, "uint16"],
         ["seconds", 12, "uint16"],
         ["Date", 0, "Value", {
            value: "x=>format(format='%04d-%02d-%02dT%02d:%02d:%02d', args=[x.year, x.month, x.day, x.hour, x.minute, x.seconds])"
          }]
      ]]]
      ''', struct="X").Date
    
    LET FormatMAC(x) = parse_binary(accessor="data",
      filename=x, profile='''
      [["X", 0, [
        ["x0", 0, "uint8"],
        ["x1", 1, "uint8"],
        ["x2", 2, "uint8"],
        ["x3", 3, "uint8"],
        ["x4", 4, "uint8"],
        ["x5", 5, "uint8"],
        ["mac", 0, Value, {"value": "x=>format(format='%02x:%02x:%02x:%02x:%02x:%02x', args=[x.x0, x.x1, x.x2, x.x3, x.x4, x.x5])"}]
      ]]]
      ''', struct="X").mac
    
    LET ExtractValueFromComment(x) = parse_string_with_regex(
      string=x.Metadata.Comment, regex=format(format="%v [=-] ([^,]+)", args=x.Data)).g1
    
    -- Map from binary integer to a winfiletime - handle both binary encoding and integers
    LET FILETIME(t) = if(condition=format(format="%T", args=[t,]) =~ "\\[\\]uint8",
       then=timestamp(winfiletime=parse_binary(accessor="data", filename=t, struct="uint64") || 0),
       else=timestamp(winfiletime=t || 0))
    
    LET GetRawValue(OSPath) = stat(filename=OSPath, accessor="raw_registry").Data.value
    
    LET GetValue(OSPath) = stat(filename=OSPath, accessor="registry").Data.value
    
    

    LET _MD <= parse_json_array(data=gunzip(string=base64decode(string="H4sIAAAAAAAA/+y9a3MbOZIu/FdwNHFibI/llmW1uz0Rjl6KpGyuRYlDSvJeat8OsAokMSoCNQBKEnvP/vc3cKkri2RdUBTlHX/olkQi8TyJWwJIZP7nfx91QrGg7OivRzeMrnx49Paoh7jLcCAwJUd/PeoEQZcuAygufDjnoDu4AZMVF2h59PaoCwWaU7Y6+utR/wm5oYBTH/Gjt0dffDo9+uvRELuMcjoTjvMdE48+cnB14zjdkDFExB1iHFPiONkqHKc7uHGcuJIxpeLor0dfv/X//ffL627n8vdhp/t1cNV3nAmdiUfI0NH/vK1FZEi90EctE9GVOM6bNxbJnMMy+u9SIhj1J0i8cZwJYg/YRdxxpnDpOBMBBXKcW47YBAmBiQS8C6Juk/0AbAtZrwkybw+qaw6wLWRjNEceFu/QEwKXkAswDkkJqG+Szu0460OpcBz5SHDHMRXmCNxO+uNJKcD9p8CnDDHQpcueP/9wqmDfYY4F8kbY84fj2zYIRPU6TlSx4xTW3B6tSzSH7ur5yMX1N6Q4DknrjRTXUQ+rHG4dzjEXIIusRchJnY7zW7d/fnHxc7d33On2T4/PLs4ujj+9/+XX40+fTj9enL3/5exTv/ObbK6Q1B9LKZbvfHK/R3oXZ/2ff+menR+fnnz4eHz288XJcedT5/z47OzDefei/+FD79NFY3oTBJm7AGPkIiI6QdBK++lK5LwW1bI+PZeHnLdo1M94in0sVkBrDxIBRrJ2LpDXnFE5q6cYh+OkgbTKeCIoK2PWtco2AmGF6SVcIWahS5aiFFdWcyStOCYCMQJ9Dm4o9XkdOyEtxXHeOE4/9GHHdVHQpANdIChChm45nFvoINtmsHRNBcb/BsjgEjJOybo5TakAd9QPl+gVf51Frg04MCAzKj+gyyUisp4LysB5twcW+AEBKIDjTCkVjjN1vbdgSRkCYgEJoASBL7eDHsAEPEA/RMCDAoIlgoSDZegLfCzLAa6qeZco53r6d+RKK+23Tx6Cv348dY9/dj3v+Az9cnIMXff98ezD6fTD2Zl39sunn39znL6PJDTuOKdnJ/Lf+/hv203U827vxPwrr7IB7/o09Hp0CTH5V4pJfgLM6s2Q6iFpSHcR4SF3nL7sgQHDHDlOsTyDurN0obso2LttQictdsRMJ+GNgK2Jqoup80fI0N3wZhWgRoCychqhuZ4MeiOGuO4iDSFlhdXFNeAWu5St3qTq7SIpe9Br1pvyoupiGo6uBs3UE0morZVud9j1MSKiIZCcoAY9R1UxYlQgd80gq9551qQ1QNYfo3+EmKnZeIiajbZCcfWx9XujPpErc1OFZQTVxSNNpVAg9hUyTxoGNcZbVFRbj2vC6iLTlVzBZfXpO0GUEVIXyXV/OIQknEFXrkmsIaRiaU2wUQ/5V+FyilhDWBlBDRBNEMPQCqScpNqjjjwgIihb1Zg6EzxZKXWx3IyGxsBuACUjpC6SEX1EbORDMaNsOab5u4NKgIpk1dYQkma0YKtL9ID8JlrKC6qNiArojxYrjl3ojzvDypiGaEnZynEKBDXCdIc5nvpIi2+GKi+qLq4rJB4pu+94MBCIyb1YZVxGRPxDVlb9pXdEmdoTXweIQYHJvOjurwS+64lcfzdLq49wgtyQIbk/rmsjaGxFcmpP6JO+h0Wd+UpiSZeuP31zAX0fyl9r7eeUUtaF1NfI9fV5vwcFusE1bAGtlpyI+lhuB5fUhTVmb40jVbyJEQldcT2pBSFduvZSxqgXuuIbWg16p7VQ5CU0OQrBLhpCd4EJGoxqgSkQ0hBPml4TSDk5dVFdQjIP4RyNoHtf/bxI4slLaDi3ROKaTC0pGbWPiVyBH9QU1V1AQmpYPxJPkZS6iL4gEmKClJdALTA5AfXnucm325pTnC5Zv2bTvrWXnryEZltiuWD8ByX1oKyJaDDjuohzyrq0zpFvXDz1YySpMaTIwLYHLS+x9mxM3Xskorvd2riyYhrrq8PcBRZIHUhYUVdOYPM+5lP3fhKgGvZwYUdLi2sMLn2aYwVeTmBjgAMPEYFn2BK8jLjm2qNejVWuUG1GUv2115UDCnR8DHm5eUPdd3C54KqijmPKZq9IJ51hdRS3fO2KvCQGVbIBAmN1gkkpS3FEfeyuHGdE/Y7bW052uOfJfSkWqwprnuJXHcyI9ZYTx/kX23juhqC3cIPvWCwu4JRht+N5DHFecieYuna/w0yE0AdG347zJURcOM428bU8brdQUVV25smlvx0KRWJtQ7+eWIWcFteelicCMmGvqxQLtg2f0inSCH8fdX6X23UfqVMUazx21NAuIcsdabNwqzQiF6gemiHiIQb6T64fyprKrBoFvlSRIMdJJO12t66MO8Y7RtA/lg0MzJ1v5RZYR75BplUC5yH2vUs4rYe1yGMtJbEVpP0n+1iVTPtozxkk7sIy3FiofbwlrzeqoM3ectjBKmdUytUxvDmNtwl7g3S7DHSdSkMWkWeltoa49FV4Ddz5y3Gr6Ifw75SZalsiUVhFK1wwaZ1LURVtcCl5FFkNffZ00ireWhZWCcgtGVfdkAu6xH+oM/Sa9lQx6pxcq6hbmNpbm8/NgXiv3K1CSbRZoVbxmnsvm7pNi2wDa0k/tWpos+5qdvCO0RxzgRjyrtkcEjM87EHfKL8tFo/E5tqyLtgqbuNj04XM48Dc8trtOuka4ovkNjpShkr6o5aovHGcbC1tsLnEXMjt7Az7iIOYh21Kl+p1YlSP4paqq31ibTZXAbd9t9sQEjgvdX3VmFpSVfu05Ci2a4tu5pWqq31i5odWJsICbtnqbFsDUrSip55EWrUJItGKRSS+Nfzm58ESzlEAhcWDojyVgppaYzUOySWdUzJRn/MVcdvjVVhXa8wm2OKMl6eihbeHvaTHU130ooVdygVmS1ninFKhL8xLEMjEXjG/OE6hqBqBV7Y/8rMAtECQRZjRk6aSC0ExxLQQbVllpVrE28McTn3UQz4S6IoKPMPuzu1U8sp6wMHNeDAEnhbj/ba7m/jmtstxttVtkeKVmPE+cdkqECM4x2QuMTTo5wmBTZItgq/ubloM+8rniQ/sFg9UK0MVcTmHGRuWgT55wIySZblnzBtGbVam42SFWkQf+TqCcwzL2D7FeCMp8rtsqXq14xiJLYD9hlaNZpxCuOvCbXaSBSznbLkh1NclJEtIuHr97zixNJu6dQMcAO1PVB+nkuI4I8jgEgnlaRWLtA72K+WC1OgHW+GmhNoGfAYGRCA2g26TrlCAORFbOwLcVuAf7QH/uDfkQxoSgTyg7Z5S+zpdIilg3aAbQSbKPhabIBEGUUXpgtbHUaXGnSAfuTUWoT7DLvgPvFwitoQFSFYB8sDt+DKH4ZzRR44YWGAuzMFebI51gKt/BnBKQwEyMnZE9VGcCRIgieKjipvSO8L37CDznTLv+wIh/28hyh9G3ko2XMUG0/qO6fQQZMCHjyvE3gKxwBxgDh4XUAAIptAD83AVFfTAjDIroYuyUMsFL9rB3pzjgLVQftEHPF4Mk6YkAD3BZeAj4OMlluNWUADBPVoBSDwdrMgK4SEMQASkx/ADkjgdZzi+lZvPxuSTYHZFIafMyI9pX9GoC1uPpGehISd0iQCh5Bg9YS7kOLtHud58Ae9RhlHUbynxV2CBGJLtyBf0EaxoqHvzI/Z9sIBBgAjAM9PImBMBZjQk3v9JzTWxHr7jP/6gjvN3uiCO49EyIXarz0GFfMHpDsYdQsUCsfWCgoJ7hAJFnBL5PwYE3RhyrATF6k24tqSlmKT+mMxBakRgMqNgRf+PvaWxEswrmj8yL4I6ocD1KUebQBoplruIWv2Aq4fgbpDfZYfHHIgFigoBV5tHgCPxW35djUd3C8hFGOwGfLNAABGBGZL4wkD15L/o+ZfnjJMWMGpb8eTkfZnZU2L1MReAzgA3RcGM0SXQAtbMURWFLjFI25hCYganTRmcFjM4bZlBtQUslNYMjL5+cCvYd+x7Xci8G5Snk/8kGbHZD7ZvaVppAQ8taaVdlurWydmXNm7UCD3N7bAc55u0ev24Ccz7mVIcJE4Bsc+P/nr09NkJT04+IBy8IkhAz2Nnv/vo89O7HhTwdfkNiLKGjfMMB+acbsRogJjA+QXLfIw8EJ/9b7ln2OgAFfUzCTW6zVL1q1/WMKiT28CHZU6FKl9JvAj+LTqOvQj+o3DqY76w71x0S7CuDWS7mEXOcRXar6PFnhxz2ei8aJdLm70y5pJu+taYtNa/vtPHj2cfTkHDfmbEXFGv5Hq+t063TrBW52tIsMWeuE6wRo9sSO9Qp7/KZmbZblkxXnfDzteQxubOV5tGjS7WkMSmLlaRQqqjN53z3jhOZtgcRE8r5le311njZ60LFvOr1x2tsavQNzvEY+gRjKFYTMPCR8nKu6ycs4npNfrsSO6zCVwiQGfqdx9yof4IfDqfIw9gAgTVtwY82q5Vc8GK0OkEP7ccebem0jrzfnuqmAx6kRaUAh4XFEjWSKgrg1BQqROtD8O3gS46oaDaJbDeS5R29PC4QOrMWSpBN7c+VZfsl1BgF/r+yqgBAnNIAzreEpO34AR8BsYZyXsL3oPPIImC2URNSnzEpoyiig4U+k+CQVfcQT9EF4wuDflXT5+fXu+rh3loBkNfJIMur2afzuWAg006Vk9XIsdYXcu4PQ0EkPNHytQl3FSNM3XjqD6DJgQPD5CLZ1jPPetsGuplZBC0oBdV0e2ghlrUrGsmXErApDNUfaTa3k/CREQY5z/HMXD0tHuphF+TW17P3N4X9ZZoTzrDl8D8zxx4+iuA7OjtNRXRcM/cmjK4uqVCXqQGvSraYD8xklU+y1bWWttdwB73/MhvzdZQ828qv1RJt+copB1Pr4QPSoI0RRiKDC0wpVT2jhmjS/ueTDv4JRcioEvJDM9DVsG3O25wnRcrWu2iS9tEuMUr2+cgFBk32wiZNfhlEEoJFcq9BHIQKoNWWS+ys0e9k4euizifhb6/Wmd9AbG/82HggZBWM9I9oY8EzCn1tramnF2+ya9+odQ+vckiFJ7EsSveWcJJpRM2swiPigucXkjTl5tpz+14bo2qLREDbfPt5cXgsn8zGPZfieKby5IT6vUElHmxkPb002MwVfAtODk7+SQ3sn0y9zFf7PuJww6ucTw3lQADjOAczbCPgHkQgqU5LKAIt7qQJhrYLa7UPrXNRyut7k7VM6IqCpMFtEqMErRGIv3s7yFSq2q5urmYAIlVpXtl5hVMFT0VSrCkONmXTLmU8EPSWs3RWCTAvs4S2QeiMrkOdZRFoBYvLuAyqK63Iilvwen7s1/Ofv3w8WfbWkyquw283TeOe9DlJSVzMIJiwUGJtDx57cWFLU34UqCSt5ba57n0M2JohoS7qNS11nXRCQLfTNQgEonJPOlcp+Cz3tsVfvohJwISb+O3d9thaw8UzUKuf5ccHCcSnH7voyuIPtl50rOH1un6CDJlgOgZEAoQm7TNGsyqMhVMiVKC7IgI4vPrz+hDhZVVD0lTjyprHLVE++1EnpveNJkNUMEt1yblFrz1rL9fkJ32G1oprfFX1xM50Xx+eqd/eH309ugC+wKxVBHBwmqnNNHblC4lRIfoLdkBYzVGDsXESHIzkmrHZGlwqeNhV7xyCABxBJnP/61+BWDSv+x3b9IBZd6mgx29jUIDvTXfN/8ifbyNf7pZBegt+IJEDwrVo9+f/nqOZYcG8i9dhqBA3mvQmaR/z4ktKi7/IBdd0yApGZm/GkEX4+shYAh6vzM0//0erV4xSkXcR96CuU+n/LMTBdPgP71xjl7Lwv+jsUzwnOjs3nkdfUMrI+U/j0//+l8SxTe0yjG4UJ182OlK5Hqb+QUK9AhXQ+hq5Pm/5iT0CJ+Esxl+ehu1ypcQ5xV1gRkXUSLCcszTAiIl/JSw/elNogmHvHaIldGknziArg/5jqQVBQMJxkNpREbA068lwKuRH87V8jny4eq1OXRCDEUDTb9d2zFJpacok7xDY1Q+B3/6Uzm38qLBFkDG0e9cMEzmvz9isZDtgZ5e6b/E7fHuHHJE5HgzDaO+9dk5+tOfHMdxfvvTq99GSqArR5YW/Z//35/+6y+vk09UxI7CT3gqM23xNxRd/dG7v7xWLW+lxVOtCl6Z6ex1SYPUOFi4Jv6IvvecrmJfg9L+TmCIPAwd5/tw0vumknwhBv2tkU2qu5Psh+mmdTUbtWXzb/YPHOvTNt8GPjVGMJ2B/6u/LDH+33TsDnAHGZYGXOU1MxHYwiWOBfYsjpgJqAmZufeQm/tlmY1r+lzhUdvnvJQGhZBGc6jOBsBDHAC6GmmzBDaIH90+2esJiDwEs3cH1cIhV0ii0sIVgh097HJCaCNk8V4b2Bx0tR3vuqiBRXSm9woF1F08YyvjVIpmIHSoz1oaKUjyfGDtbuYtZWVHfQDvPUL7y6JqNWHEi6TeMOHHXjhPJUbFMjmM2m9Wlr3Q9LGLCEf1pilbGXNeSIM2SXBVheJXFUIJu9AvyTIpUHfHFHl+0ZC5CFxP3lTYHTXcGTZhu3mHVECo2m7oQFgV7oi2kyu/+3lGjrt3QAUkK+12npHcxh1PAafyu5vW3KNs8s7ucAr4lt/NHEYDZnc0mxuwxO5lcwNa37vYIV+0g9msgbK7ledt1922bAHDstbNC6RWdzfycqmW3308L8ctBusOcgdNq3jHUcSo+u7iJTVYyd1EdUqRY0LHg4HYkX2/hFcCNGJq35rqC0TntzPvw0f06ZfTY/Th9Ofj9+9ddDydue+PT349OTmdovcnH97/+pvjnJzUv1Ld4fcB/gJiD4eU3TWRK+/nIpeCL0g73uQlgb8A5ygvwTl6/Vrd0ZoGiAN6pb6oFvnPKXttaw27BMka7V3BpxxaUn48rwajh7Otw6FZFGzHMaHNWrEc6nJKjYuv3RE4ZxR6LuSiuu9jFU30Fm7QpYRcUOaiuM4LH86f333MgibT7mOUeWqDG802c+3lwrWXhgtJ/JwZZt96my/m/cveWVJ/1unmAPvjxLzm1lrRMftV/jJgSrzqXU1eA09/kA5FgSO2b6VOA0YfsJc4E/RWBC6xq2L15+CNGBXUpT54JQfDa1uarplu4EBnsYTSRIX+LuGJ97LImSHxFTLP3MH9sNy6NGzhlajtsT8YAaiXTsSLx3jkkatH+d5H+GBUJWrpnlUpKENpz8GNM6nO5cKl0fu4wO4ifqQ6oe49EhxwRDwO/hEiJlvmcYEIwAIwxKn/gLiagnn8HjRuIEs6lngnCuHhKjnbWaOuWr47mibQpsGcQZUtRD2uRZAjvRvJ1CA3ZSbU0gKZB7lRrel+CRARbGWpJQ63FTKzBg+nBAmwhPw+7pRp1aWDxWS0h3AcySinQGDEtKhbBXoI+f2L0i/knLoYyu76iMUCwCqdngbZIwRLCrwODn9le6lW7WFZtLk9LFdvpNrdwGpJsrofYcM6DH2BXRUDYW+6i+v8ERRYwV61oMDDMzcbM+LaqLiCQeeg9lxFTbygj8CnZJ6yzCjJmxfxqU3c8ACrkCnYxhC6lLUeopISO1hgFaYQimz3B9D9R4hZxq6lch/BU9qzpaHrqYCYIK+Rz4GNK2v7mlW7r7UOGKuZ/zndGdFTgBmyptYbxJaYQIH4j6PYPe+P0xODhWY5wM1xU0qRn5e53GvFjcaCwWnM7t7VxHizpV6Fw2iT6cZ3jMk8aHJu+YiBV1eDrg2zfJwCUCXWxKHsIivt0pP9N2UgfwjXVJMHvQ1PrpcyS6za+7g+RkTocyE918QLhcnmpeMFC6ayATJE0GNu8dUrigUl3rz/sZU3je4tAdSKVB6t/wjLpOkqob3TPWrvY9OpfFsS5ee6+N5OqrWL7+2qeJk336VVeQA337v1/2xX32XV+FIOCUuoet8nhS3PZM98+b0Hds93+71/cvu+/q43/p/7+nu3Wp/jQLK0Ll/G/fduJT/LHr+iln+IC/DdTXG4zXDwN+AllPsce+/mCt7bFXgVDe73Dvx/mXl7WKZtO5fg21XwMm7By+rN+i14GeW9iGvwFuxWGxo8PLOzOaXnuwiv3sj7uQjfrrB934TXMIjbvwkvoaIXcBVeV7XtXYWX0OuLuAs/7L1y9bvw7e1ygBvlxpye9za8tOW559vwMjp7ruvwPW/Zm16Hb1flQe/JD+g+fLsW93oh/gzaa3whvkN99m/Eo1Xr/YlK7+Bjgiql2EiV77gCP2CxSgRV2EWOqI9dLHkWZe3UtUc7xqiiC7RzPttXWuuD0GFKc0qdqzh5iblXdpwRww/QXRVp0nHUVHoICu36OJhSyDygo26sKqkzmxxXFZTrw5rQlnQa12Oq+V+g0MmKuKAjFcWBTpxQrsMm4frLDf+O79PHrqwmSs9gEPxTx1Y68Eb9HtDccMsRAya32yWdzzGZg1eT2yHonddx0VEhCaUMZYk/QD82OrXMd1FuFoA5OD0DCxoy/g58PDk5kcr/eAI4cinx+FtVED3BZeBvspWSlKnDgUo9TVUCa+Y4k9uhah8fk/nAIHn+89ALzKQJ44Nx6FfO1DKLCjNZWB9K7MgR9T5tD00WkCFPt3TWKopg6f6c/B6htGshDTtd0IlOcSvqIFMWMOTD9ZhK78CN/OUerQChbAl9fwXmSHAwQmyJdRayHiJyy6Nsz5Bjc+DYGQ3AMQg5AmP4CL7iB6SOI6BS2e5sIcZyVvGqTtdszW+IEVS/D1YIz6SIQoKIMKr6nE6YtDVqUr6kc/Qa/L//B5wj50jHZwImVlplydlyabn2ojCpqTlYUJJLUWym982TVnxWJpcI1SkgWMbC5PLBZD+bItlTlH+huZCd4wf55STlYLVk+V0YwCn2sVjpYRkvJV1KOCJCnZ45TgLFcd680cmub7k+eZ1IbM+X26E9ldMgOFiV0+D5NP4dTV24tKDtRyXo2Tu3hqGmyDcH173tK/t5u/UuZT9nxz73QyQoFQuQ0nAFtSfloyx26uhpAR8QmCJECoIwRqnBdp4lnd98HV2Pb7Jmk0HkOK0FXbSyKt5RP1zqlKWgC91FiZn6FHwGY7SkD3Lvo9PqXuAnuSU6A5+jGI1vwc/gM7gOBHah/xZ8lGU6Q+Bhfq83Urfknuj0rZtzBWifZ8fRICVGBXG3Trd2xAq2Uo/hB5WSc1PSQPWFm1WAPm/eBmy1fGIBdkNO3k7OJzfX4wqDJLqCu52cbxoigR/O5+ouIG9TD2ZAAj39KPdteosG3AWUCkFMTWKYAJ0RERAVIPht9ldZjhJ/BUKC/xHGl6pb46D2Sbh0HMO0yTiL23tLSw8hCWfQFSFD7DMPfCw2p5MEHAWfnSOtEefo9X++/y8l4wYLH1UufKoLm8m8cvEPuriKcEpcFKVUNRlVc8VBZwImql3epkaByomquoRSUChm7z9GCL4gMYaPmf6d6t0/jRgNEBMY8Z/+++ezk+mns1/Q8a/Ts5Pjs5+n7jH8FZ4ef4Qn018/nblTD57+z08nJydnP/1LHPJV/TPhWZGXC/BatuZfP3jw44fTj8effoEfj89Ofv31+NPZzx+O4ftPpx9mP//yYXr6Sdb8ca1mleV1b9X/nK8+k1+37do/FtWuJvr26/5F162rVkl6EzEGkKC/qy6JBVrGiYG3deTf79HqLZCmxjt9bSn/pn5Kmnd8PVSpeF9F+XjfOEdvzZ6ess/OkblWXsk/q2y+ZpnQIv5HQR0iAT0ooP5bXuaf3/zZFE1SIKcrgI+/J5XYzv57OznfvQaMtF8rB3eDnk7rO+iZeZnnloR3YAiFu8hN3jNGl8BMxEoAVwu3OqNLy4T6QLX8zO44d4Pe7+3O7HfYqzypnuhJdVSj6Pt/zsf/nI//OR//L52PhzQkYkQxEfx098Ssvg3018ExuLq5nfTHpVNwF+SCfAp8yuTGP41DbvUbp+JWApFXfncuOzP4zrBAIA67L3cB6l6HCMwQUP2FUAEQdBcAEw8/YC+EPoiux6Kdo647qaUdp40RZUJueWucQBRtrgKGHjANub8qkQCiYHNcAMd68rzuZFCBZeLHKQvGRCumt9CLv6m6He8lddmVa7/1z4oPkm6vuiCQk6v2MVyafh+5GPKFPndIhqgRrA/U5PQtkJx0Go84G2RCjpic/NQ8k39RJr9Qkd4tt5TZ3wY581yLRW9BKnIxVrFdPuq4BwzHt9UpeUxfOS6gAI+IIbCE+rR4FTelnaUBBqAI7vM3qGow48ottxRBfGXL03l1eCSm+EY2Obe9hGQJiXbdNjfgvGAxbD7vRF4UsgNy8GrSGeacJzJfyCjgNjVCOcAETDpDsMAP6QxPnWH0OpA7jpGix2JqUZh0ho0wX1/cfO+M+w2AGwk59OVztc+wj0rEv6iz0OXJ9ru348HNv5cmex5iXxxjkiVspOQIR34UkaDdJ5fIDRkWq2r3JRGiBn2vmNWO/qcKYeI4HR9Djhr0wMmKKzchAv3chBFvAEHqpL/IIPF9MFnxQSQF3FDqx8fa+iFU//ayo+z/QCDvrbIyXe2jZF6loyfkhsJk/lU3eJT60bt04/O/0iYp1xMz9Dx9Si7tWEqUj0nAsCxCE3HZydoMDjW9xKz1u83Qhx2Dr/E0/K/hMpBGmtyFZXU6YnTO4BL0U/iKLFlpticqUU7cdAagXG1l+QZLUHTbk8PYjPAYuYiIThDwKnQzpZrySYRZ2WmNQ7JmP2xnc8Oge6/uM5eQeFwf16neGxIwpU/R4w51nQ6WiIRvgU8fEZMrP/gTeKXOFtTO/cNr8BksKUOAKVZWLI6YUTPFdIKgS5cBFAX3mNsV1PnWAZMFXqqCb4EHBYwvpB4ZFgKReO+ijy6gAAxNKRXS/HrExKdzSt6hp0JfxKwj2ARpL7P4Ej6LO/+7dWMkFn/hw3mlURFPAmasm5lUGmWpiECCAhYS2ad0NVh7HoAh9ZD8q+kQpXtOoTmwRqJZ1+kOehP8B6o4rvTA9leAwYxzBt/v8OnSZc+ffzh1nAyNZho5h+79nNGQeMkrCdmCDArKwKvzNTOiZNdR72ZLryGbHC6kxTERUCBt5k6QkCt2aWeLKoroIX4vaFCohV5VLXSGO7n19shtjObIw0LOW+pwWS4IzVr1Hq0ADRCJzhDGaN73cJN+3gkCH0kr2YBt3LOlUjuc641EaapfbgfHU8iRl0x+PgyJu0Besp56uq9YGdUJTGUFFoWOq3FKG2K1qIBXd5gL+Jd6Y5igx8x0l/cT0UPbdIGdM77KYov4JXWhD5Levl1vkwXyfceJ+FhUzOnJyclP/zb66fTk5MMBqaeEOq7omMKl4wxvB3aUMu70OuNaKlinrzZGLCRE7qygAJQgEFBMhDI+1Qqw4clCiq8C5DhfEQwuEbzvIYFcA8L2icAIEzmJ3UB+P4UMDARa8sJ9s14VNthJWSHYCGk+OUiJ55B4jnMBHyjDYu34v3pr36wC5I2gWNTgKUul2lmscgeTKbsPRCzsKCIN2gL/2/Flafr6WAGJmNFPfW+OgJIDjKAdDNdEGEamdMM5LaoHXM9m2C04dt7Mba2stnXBBfZRbN7KQWH2Q8bGvYJLtNXEjY85UkrQNURuxwrTcHyrfpHVWTl+/k6Z932BkP+3EKlHoqW0oD7R23hkZ+BmcVg5D1AuERfU99SQKsUrVeQtEPp0QA7V1LT9Z/WkjAswU1/TgxurW0uOSHyZZ4a3FzI1rxNwHSACKAMTudx1uDQGGVw/7mq81UlRsKJFiVtiHmHPrzBOzNHKTA6L/Dpv7GDKAIcPyXIP45mQy1UbeBj6dA6m9MmyitYp2VHRD6YeG6qRm6c7zLFAXr0OpK63onA12kBUd/vqEch0BbIHDHLsSfWpYlq5HnXDpR6YWI/CbNPb1Fwh238qsIkCL9EcuvngBXVPu3vULW3EqAXdLNV+vHdXO9pWDLYEoZ3D8MQsAZdrW/oSpqtmbvqAdgPLma76CdaG11cZTbwxYaDWINnhqBfi3Sx3Q8tIsgKuZ0ZPI3jJ5n+DVBtQq4NLdfC0Gi3hucDEs4bJCNvnmNqNzvqA0Ga5sg50V66+Y31cqItaNcL/zI0wbepydaFhnGsEtXaYt4a4odmPoAgZuuVwjirTl5Ob8d2nM/0kNZnwFlBPi1haZRAQKuSimgqsV2YurKafNBl15HsOvTm6DTwokGdnl2RbXTA63UmbFY+w6FhY6POfdjR1qao7UB1ljS7+iIXWDHVDDl7hd+gdWGKCl/gP5L0FS/gU/YiE+7odfU0MiBehMdmfGJ4vxLHrY/c+HWnImk4mC/r4r+EyuMPo8TCVkvgmTEMhjFraU8gNg6tzVVFX16H9QRUC/ffDVFHXp+79s6pIIThkFano93I6xmT+rJpKAzlkhV2lF/+u3B6zZ9VbGo+Gc8ja00fHzztrKQgvQUn06Vk1pM4XD1E9C/oIIieUZ+1JC/pocFjqTiaWvQ+0Cz7o6vC/r8a9UbGP8i79pTOA/LSgXOi3AnSWimgR3zCrfU7mbdKr61BMlcuTQbBDs8X4bTh4gldfGA0DoH3Fc8rohIKykGR9tdPfV36d39CqWpCgJChoxjOzhbt1RVA/ZixDLfI5SDzGwkDuJkJ1WjcLfb1tVS6YDYbDOtdaTXdNXHSY7CQyO51z8u+Tm37e9c0iu3rNZalr6gY8EIoFbWaJZtqSKsHyCj2mnTjev3+r4mNBhvQBOVVvJcy9vw7/gDwQiQKQCTyDrmhyi74OullXVhs6OWkah74SWlh70Jv1hFbR8kAYmB6gl5mpBGljlTZ4O0HA6INclcchsbJh/xEU8cHOM/YXrwrzB4ueEc+iklZGhpUn8S9TG4XD43+rPnaNESt6ketf6BvvTw5eyf8pt9wyNkWsorwYSNSrRcy0u73S1U9cbg2FTgdW7VVtJF57lJr3R6qmFlRyd9UFdxg95v3UbhaYeWAEmViBTspxeINrsbEkmInwrcJzU5ARXjSvjhH07666jvNA3Af1RSuz49+uOiPwtwtM1tzvqtFS2/9U5lklF3KAhdrtQ87xnGx77R97VsqSjvO3mYLkON+vL/Xl+oOdSAY2CQ9GoJNN3d0GbZ2Z6qCIu3ocghlmS9k9wYMekWk1VOZpRvVBERWrINul9UFMZW43q+Cwuu6Sesi3wWwoBR0UNaxf1wMPCtV2Odkl6Jn3+T0omjfaDRXQB139drkWuZyE5M1+wab0ywJzX7nhr1VrezncL7Hv198/nn04vaIecpx9skRwWXvRj0wXOe1Hi6PK4aJ8NLdEvElqdZwhQtJI+N1abKJGlG61wxFaQuyvRVzKSN7F6zz0vNUlnWNyGKxSySITWcDTM4uybcqSMrPR89PaaJ1FJ3pxNOyilssMuTTJ60eCydy8/zeRV0pkWN378MvQV6uBCqsFOX+kzDPOTnIXgkScxyl2mcWkmlLi5DIjI79g9bChkY5Hpwi4kb/kWqalaprRfsM6JbF6+mYcqHUtYwTlvLw7Qpf6evMAGBlqRZ6RFckZf0jtLJmhZGhCMOpdKCUob7dt7Byn4zI6hcKIcJxe13E6d18QQQz6jpPFrcwj0RvcoKfmN2p3mIfQn4jQw1T5oQ7Ht409W9NC48dqiWCLiIfj2xLvT6vCjaSqXyL5dlFHDt12gV+hxxGjf0eu6Km3QYpKVJV6Rm4+lj8LlYxZMGzhhewvx/+BgyYDKjrwMq8NiBcPseTtbJL2JaquSD/qM/WkJGA6nozjdJhbnASzxnNJTMb5p9/VqC5MVkY6A5C5i1zowoRkXFMRy/jDZmz6DPJaC+CIqhBe0AfoAXuIuDpOCRH4eEYZIhy7my60dJ1Wjpgu6XyIBqQGflMSfKE31JjBG+Cab9oJBQxdhsMlGKOZj1xRA3dOAsBLOFdZv5j8v4cZck03L5w7dGnHMcVz71644wyWytHlEKjmLIk4oBKhQqW4lttx1w91QDlQqJhNGdfjiFPn0L0PgzHiOs2TMnquqLihEwIDvqDCiI3UYj/QTHM9mT2qNjgZJNKoyhpUcbNHiava8RBoTkVHF0cMeVsZYBcRjtowgS322jibWSbfZq6CP3PQPb8BM+1lVsA3Hqjd8xvHmaB/hHKurXAz00buQntKMql/5T5J2Shr+/78sI5CoaxnIFtXmUmYWyZw7TP3lUiUmmbAlxAyD0Ni0i9vo6gKRN8/bI6TQc9q60axX40L5qB32PRzQSR0oPT29NEJAlAQS/0wlLKhu+s05Tp9eMCoUN6n2ygPB18c5w4xdbR2+KM8nuS2rgcqxC109SMn2SnuJpNtSribTFqi/h2TSXdU73BaFyy2QZnABIwYvmcr34pZbQ1o5ghuJ1ArZ25rId+r9SlMZiqTtOwt6Uv/TibOe6dc+PZa3hw09DlC99bPkB8XNLpvU9Gs42oK26qE28stMeIc57dfO2f99x/PPh6f/fpr9/is//P5caf74f3xxS+/np2dnPR/7Z32fvsd8/d6Nh0QQoHKT/5XFTX8gPXoQzIP5bQ6o8ycvkai1bF0rNLn1+SlgdqGNvGcQL+xLmn02FQd82qhAKeUGGXjNI/l19fp7NGU9+mjCxE6PvmIPh7//OkX9/jT7HR27P4ynZ6ik09nv07PIjWpCqJjOiueih5178GF3D40mnGSVDY+JveZx/GROjCL4n0CKOLUzrKIUdy25/ERVMfRWKUysMDQj7bk1lw3rSsEuyrfRqZLbA98WkBWyjhcismroCUlWFDG09HOdg+BdcKpKL4qIganvnorcAktXBZY1EGKY8DwErJVpIKaVEdaylALsUL37Bu4wx6ioEcfiU+hBZcXFhKgkyDJBaW4giK/l7N7z3zlnUuXjlNQMvtm1XFYSOzE8m1BDepwLeWKVlBFflUoCNjaVEMShS1fthaUZC7CoShUzwbro7pOLvESC+44HlxFf97oT1V0/BWfzL1CAXUXtc7AWtAeVFm4kieu61VoxwIv/tWyEg938EV2mNkfTP52iYXqbnAKOVo7RrE8S0U/O06ienUr3Js2jxxJkMokllVR16ehByb6Vme7B4KJOprEiDRrVErwjlvkVJBZWY+cZ6Lguzr6PmJvHGchRPDGxsVQbcapBfiVu0DuPfiKH1TCwNcpB6voKizuM3LZKlRGnzxgRomsxnGib3Qp4eFybYf3PDQrs6r4+mNFXEkyTrcSCTSxhqPP2zo6aKQilZRhSD2tH7W/iBytIrmJ1+c92nQjKjn2yRwTaZ9FeQ15ogo1LJKLs6jCG2zBAa82f70dzVA1sYgxj3I5NuebJMJ93sFwO75U0bN5AF20eTjX4njL/Fj03lma+OESLpAz7lyHg34LTsBn0MMcTn3k6ePwPlG/NCc84LpWWSRVZyK/nAnVfxIMukKFNr9gdGlIvXr6/FTNjiqns6YjF08ZZCsrLyUadeX08YdJlRtFwjNTficIpDEajecSvT29khe0t67RSlrdRtTVBioM9BYBJ2e9cf7FKrN2IedU1kgzW+soiXvdF/QYDXRA7rZW/aQGO4u+kbenNT/K5pRVUPqvm30DuflWnCxl8/VoYQYp6747/QcVgZfOufzPXEKaRFf2KXbJ1za3vb7qlyzj2NJRKdBdQEKQz8Grb2gFtMGbPWFYXzKO15eMMv3k++Cqf3fjOFGVeiwVrw5VPE6srRepDWNKQ/H030TxsZBoL6Wmp8L6amg/nfPwfcoD7ftw4DidUFD1ZoI5jqrlks6PU1WX9jxrVfe6jh9d7ZrlYWg8n2smq+eiTxMHV8xF/JgqivwFUg52goK1VDbZq4ui08uyBwgeIkI5o5ifVPQsOZVIQJ0Ij/VEPs0UdFjqeX7l6DQ36mY+2lunNLSmnnJ59quoQ6WysfLYrbEulP36jKqQ9uxhaGIW+v6zdgqGEfF8O48gG2sD68tp/kzKMHfjzzpZZFyejfMO5ACGYiGxujCVE0tPmn82N0Hm2Ugi/cPHn2NF6tknG7zFhsqkRsxroI337G14Tf+4Ch4xqt5o6IwbFt6O5MfNDQu55BhlPeF1lBdtI43MKKtR+jhVqXYJVzoXl4kja4xK0PewwGT+Nvp9CF1G3wLKoj9I47JU5upsWr/EcXeNpvnTGLmUeXa8QhJd9Z/cBSRzJHeU7qJw57r+5VKvoKW4zG1vbLkvKC8OVqWPalSEVV3RG8f5dp4cYKG2Hj23po+0Q6NWiQ11jKB7D+eopTfxL6hzTEb/7CGbddJuN/lC6VzOdwtGl7l17DuagnNGH7k5FUiiMKfLbI3Hkpk1dTHH0eWszIBrmWVLMlgrV57F9ry2Q4ibu/McHKvIawL0Uo9SfzCOV+gxSVH+g3GbhPM5UubIBKuJ5gcceSNGBXWpr3O2W3n3fHAcL+ljJMlxBv3JAi/tWJIHx1TOo/Hdhs5d8b+GqM19gZfP0bGRYbZQLXqyoJVW6nZ9BAliEdKSFPLFyoeKG2GGZ5QtHccUbeuJmHnKmbM0B6m3UfHN25Ztb2JbcvP9KGRu2n8y/0SVV7s/TGO1rQeVJbP/JBDhkbtoaW2YVMhxOOW8x6iK04TSsi2kjsE+6j+J5qZBx/N+GqMlfUBxLGmQBO6p0SXWu0K1Vo7ff7UShGyPZOu/fHvpzDNe0E2YV+/OI0a90M2f4ZUlBX2/aCoL9Ia34nQVVWry0PaggOpILgWxhUfVyr1DzpTrgdaqaCGSlJqyi05Vtl5Tdn3IOdKhwUDyPKnalNcJAhWq13HGKKAcW9nr6VfvKdXcUT9cIjBZQI8+gi4N8CZ/IRMvSIUI8pCPRJRxlqBHfwVchtTEz7UkN5LULFBQK8GBXpoSJvChnShJDRQRnbTFgdRjA4+H03u00tHmHqAfRkGmpopmdlzxBQ19T8WeYpp/RWV9Qyutq/gvB66mJBJfFFUMl1SQ+ZiymqpK+pX+oBVVGZWMeyMw0WEC116HyiECvobEBIdLlJYqy03ZIqfti9D3gSGpzczo/ShiS6zKvQWnRV+koSj67gfwWWVyiBBvFHpW9MVCoUnTJEnuNmTIyOT0wy7iUfJDqYxD8A2U7dHV75NVlyw6n9/Sqhv80x4XSCXwSi5XgQsJgK6LAgHyiQ5VhsbolfR6xwCvBiTOowiQ9lZ7nfHxz37FMwVf7xpDOSC6bWY9RFY3k5RSnt+nTbLScU6T62vZReu2VtQ+EFwh8UjZ/fElekAmtRzM1oE5YOgfIWbIA1M0o3IPDBhaUoHiiAVJ28mvIy7g1Md8gbx3uZYkNC8+kp1v0E1fq9ym3zGRasIqRMC4Nzq+cQPzkIUjllXo87d0NHn00AypKPx2B+Sa+A4ReBKs1H5ANp1RP2VyVdKtZ5pEt0/UlCXnwKgerXBTOFXnIUyBz6HyO8xCvleFqxoPUd1ZPUuoDwbqeuaGWIeG2LlP3fuOUC6PE4SScGglXoNtVd4kWF0hESswX88Po8dJsCJIyC0oE8lTDHv6y8n/cfQWTpdYTOAy8BHvUqKek1tXXkElh6DBEWVixOjTSlqOMzwPWUHa1zITZpS3SvYOECiJbk7itrdJjhMjcZyHM0EfzhxHuO3sffpPSB14TxbI98F1gEiU6KY070jEAv8duvdy9/fIAXo3f6efNQoKIJhiAtOhqM1hk+OYwnLvgHzfcSQC7VcIiec4/9LCsdszUS46bKvIvvrR2VfoIQ4G193y636JYb5tqY56obJDO94DJC7yTC7JQxjlNTSi7BUdQLjULFhOPbrYea//HYvFFb0ZDV+oepRGKLiiAnR8nz6Cm9FQa2asdzf6D6fgc/J5jb704hVEqABQKYCbdLD3aGVSWuU1VvyNRIVFn9fT6TeUP6D/IdQKiQdGg6sS6l3/ZrGa89+rre7R4OqFajyzJRwjlz4gtgLf0AosEecq+wQSUSInI6fjCsrAnNEwqKqxqIZvaDXU8luwBmqo4VTucFNMtQhLFCc0ZGsBSJ6J6MYRtntk7RpRzUfSgQyjcf8B+9XUqor89A1ytIJgDAmnOr0tFEJak+pq7l9DfwVOT07fpzwU6GPioXDuQ/f+Ej8gPoRCtOZwNKKPiGlDeUBmtDTFLp1CX24dGb5HUURzTAnoaI7H4JK691MswOm7k8L9Y1Kz42BdtW1yY8QFwyqCacdb4vrnztkTsjWxS+rtvPe65DA+lkkEqPLW93zbjwq2EF47Lxgj6B/f4KVyUxGmidPnBTvO/LaeFxQJP4QRP1ktIRHIBX3iBRQTkcVXse/ATL4zfe2qblbVu7MpQgT8I4QMShE6xfeO+ov8maIiyU9FhR2nc+c4f4trc5y/Jc/NHOeipSckL6Y7vpjTvoPRWeVLxxemvP6T64fq0h+IBaPhfAG+SDMQRIYMePVldM1fV77lSATr6F0HPewSsCW7xR7Y6Xwyxk8YuSqMOLgOtDfAgPy94nQ9QckrYXN/TMC5eqin6phRBmYhUzdjqTwcW/VxdVPghbgFtpqEe2gazuetpJ14oSqbyGVTjBh1Eef9JyzWn+7Y0E7am2QIPQTOV2A4KXzAX9ZkTLmGgKUUOU2JBMdqUwFmyv9DPUuXGuve9Y9PT05Pjz+cvP90YiWiL+hCd1Hy4cUNoysfrivHx+r5vDrnHSISxi9VuNo70AAR4BYdsncm/VH6WgDrt+5rghQDrrcDVJ2Su9Ep+Zs3Ne8JKpPRG6FxSDq8+MqgEhuzuVHiUof+tulcYIZm9EkCDihZj5iQxWy+HXUYU6LuJL0DUvKCowa6pPB+kY78cI7zHoLlYJqiLWGsCKwdMOZR96a3OVk4+RfdaV2pl+ui6NVeE3jvrvo3Fwwu0SNl99ugpabQTBnjgDKd66CZXpP1eANGlfQb6cxIIHkFUG6EpHCn5aRCI4DMYLE/3zwDfDWTxn9/4VxEOK2brXHTmDRZgY2NRPO+IZtQr5XTCGEoKKuXNXgTQLYKBJ0zGCxW0vzxKdy6sKYxpooqa0dnZ1ChSp8CmgizhlXMVLayc8g6nodJWZxi5jjpco7z25vfNFBpDgd2m3z9vXEnCBh9QF7JqXn7q+MCYZYn6nUC8Q/nnfGkPvSMmOIoVbZxGxWBO+hjr8CnqBr8dWn7o9Cgy6R7Stzzuz7HXvxJqxwu6SMY4/lCcNBjcN5jKhFbTTKJMMeJpKVodYKg7lnpofKxvCRt5dP30YPq2OqwbGWHVk7onltLG9sg3dVrckpvKVof+DeU+lNY1l4oQGsE7Auo3qEXRn2ohTotbm8cvqOpPQaJMMv4t9d/O77UwUi+UnrfYNXIyrFMwRy0KXOsLMbUeZouFxvuadmHinFLvNzDAXlJoXeOFvABU5vb6ugMuduPXy2CTiioOpy7JuZ8tyT6AmE6hnxWmuUOu4NCD3PXKotEoGUinSCQW18oLnw45+ASrtYyB+wEnboLAOn4AynBcse1UpmA7KJH6tSnPt4ErpaU7KsPH2UbB17tIFVhPAzar1SUd3St3oNtQM/1XLU9Crmgy5eGOj7emvTO2zE4qiCKdWibqhbc7sSYVqXj/Peb/2mBR7YOsyuySEml5Goyu8fIjaR28H04tYfww6ntKx5KBLCnyLQ429uaLU4EFpDv9I+QE5AUCX3ZvX8wYi2svRN3gbzQR+AG8nvlCADOpejmjCLJjhOLdhwpu41JpoDGJZ2XPmepzEMJ3xORIcREIAJJ3s/EHp1UFXsiNfJh6buTynSU8D0RkT/ZmAAKiSjh6aPKSk6UL4KRxvfjEGrnGOjZWa0IXGJ3UPMhxoGy+gq5zUuN56Zj+Y7muenILy3hj0TIZPeJUP1Q8179d4sHSuiGYWlr/0iL7e148AOxMd9umRFDrVndUna8txvYdFJ6NiI/CpeUhB+UVvyquiV+ST6IBCuYPLhfaT7QdT2SWlJbl9pp0Pm4nuPQxsZ1LaCjCdddNeL2OLTtBlJWCdTOgYRFRVB1fvFsykBPh6cO9LQPhVxzdX7JL6i/HnqujhbuMBMh9PEfxsFR3eNKCpfUjYKeZivdB80sSpDk+2pKN5mMtT/agGDxg7AxgUEmeE6Q92NRu7TrWf6cjWTVnf87Jj6dUwK+YAJ7l5d20Pr6yF3K9OolXdkF18R4u+WIGQcpe7DXZVuHL2Vjgm1YVwnulFDrgO+GnSDwkV3AKaHWAXeCQD3hsQo4JdQ6YOW/ahVtJNE+1H+f3PSHdrFGIu0PtcHX68mN3YEWibQOVu4Cl9DGniVBm8i0P8h8gRiBAqmuxkHnAWIfTn3zu92xl63LcXKV2fffNAvjqPKTmpKr46jwnY3N953PRsLzfdLS0nlFBZ6VfWhSjoQWGZ+t2Aefy5nRZciTv0IfjBh9wB5i4ALL/l2xcQo8xjI1Oc6Wqlrqc7u57oPkntiNLjuj9nhlpbfEKHlkaTKpfkV+gBi4nv4draX7q84peR9SLL9tVheYeHXnvu1pQtNyW3mdv4GDiviF3faoaPmW19OYzGQBGfKkURIdflc8hNpGpUB4ezyQH2Ugr/JyqhSLnOhWOQxcSq4fEPPhaqCm0RnWvqaWCW2sx/7IqYHOPKqJZ6XKDtyVa4jnPRgKqmLtWm1iAUYMRY//m1MRjpOS19KsXQZKKmjfynEmqrSctBah8OgjsdBvd9fQ3vvMZqD2wvyAyOsA1S0Sjys4RNJ74t3WY+oob3FTDmsC9btInRjodnzZxsJZ+V55HXYSXTRZJ+xfEMfBTePMgZZARwHe45hOLw209UO8/aC2f8ZvoS/b77fjkFxX9lnYl6OBAdev6ENQCE8Lsg8weiRuAWI6cXA7IC01dVqc7dckamPZu7xsrFAtybN/Yq0jnqbOCWwZ/3nBSUyxNhhktkk95MPVZfkQc9s5FIu2bt9EEQP1m+pGsG9J7FL025vf3nFvmnm33YPCbiyk/UGPnINeKHzrLvR7AW9CWlsPobUH6PHfJ4KVT+xQai9G/8C+D8tGCtXfbjfocgSpctDlNLq9BF0uQFoitvEmmO3EOY4wVgTWLhgzaEAPM+QKyrbfaEawotLp4NBD9YB2TV47uI1SgHm/tgtxosNWQkSXy0EWH2tc0jmdzbbBriUwegIn//i85LZu5OrIOwxq0fmjRXapI81DIBjn3LXGLz7Ba4PeWh4PG69ECnKDRG7JJpvTUCdne5kshpRgQZn5aP/BllpwRx64NNpzX+KpRUp8R7pvCRuYvNwJ/DhReZJ+JJek2/Z9VZs4e8hHcyiQuQe2jnocEsg3J3opBVvJaDG9S7tIB5z6UCAvabqXgbu9nmEcD0Dh5fd2vKZoSxfDWvq/gS71wyX5ConnF/pblcH4b3KgpcVYNkpVy6En0KVEoCeVS6guYCNK5x7NyWrFcWIL9mjHckFJwULZhEdK8H4ZqYn7Oy7ayTThE4t9JjagT1y2UkXkF1oil6ulrTG/mav8O8QEk7l+VViHazxrbeRaVMt+23Xkw9UNtduKWmabPILVV0rvLUx8WUGtzHrR6tKDApqKai8tKRntqTfK+9BYvXlBLS3fCe64qgaQYxnt9QS5s2naE1Iy2rgn6z+BEaMBYmLVCOmT4+TktNf+UUWTBUKicectlNZOnjTfv8A+4uqUxThwAlt2XpHwXfN3O28btrFs3nQ7eG5ozVaYdi8ng14l8KpEm2jAgASMujqSRFGA45LgsmLaAntJXeg3xpqR0p5euSiOx1pao1pAOhfW5UB3oMOH2lIaEQ14hBjHXCAi6ixBaeRrktrqDiNG5w3Gvi5uH1x8bQem0L2fM5VJ2tYKk7oTTKQ/w+lCQtLKPiFFa7/7hXUejQzyIh7rhvleeDRf5YvI7HNpV6Hy7Y0cKe1ZjDF92mCNSBR4ae9jPsej0UBZI7Gn7WuOQ/NBskZkf1uZhVj6M+yjUtn+t1CI5Owr07965TGDLpLqf1pNRDhVGUkrmp+xmGQ9zwizD3zEqKAu9bl5d18JblxYZR4WJqmkNkHtWqAJzDqmXApnYr+1qUvLINvTprS7jyeB7LgNMa9LalnH7UO3r3jtCHOBfdThnLpYByAE2+4S9OPkJZyjEUMPGD1WYllcYYnLhbVqW9jxaJDgZhUYB43yvEyZaEW1D85UAB4xqTiHr0NzHCWlVZAfz2yA/HjWwqG1dsGRvYxRfwgJnCNWKn2xKTJB4o3upYz6jrNT3jbg+u1bGdjnlIo7xPDMxDuRW2sGt76bK8a7QZBJ1FQiW395zJeTDsiHgIHuPZxvf2hVjPty0snHfElLs4dYxTeyhHeTLHtoo9QLTZEWybGH8prrB8Y1wUXF24R5hcQjZfdx3KdrtiPgbzHenBjHUXLU+q7+EIm1A3rEcJzwrjpWVTr2tUxlY4vk2QRZKu7TVpyp2E5lntmXBziBM7QrN9yGyd+UzAfcsw4NDDHBS7g15OUuiEZEW9oDpus3gWhEWIdoZo0GfXBNRMGfLOLlKiiysSZU4sLEf7Ey8owwbQGU84asj3iEiIfJXFr6Y0TgEl0HiGlr3wIDlRNqcw02O06W1qR/czvq/1u/e3vTt8AjJ64dzN8IfSS73mKXBJyW1ZKGw6kubQNuRpgdvPkMCebpiLGia4BeS4vw3eOOw7zg0YsfpqSkt8PiOyYqjp3c/Y97o+Mbd+vzmrJMEqmOY8Tantq/X39v0sO/X39vp1fvjieRAVQhakQVFDueSakvmDO9pXeJSc0FAVxCxtVmNxcBiDxgRskS5Z2gbzlioOMK/IDFKsHzxnGyRdJYbif98aR83YXWyOZ6k683qFMZqoiBLiUEuQWr3eb6TVH1+jgurA/G1Gg6AGBJxKjv+A/IvBjqcHzbDN4YuYgInST6EufTKG3GliSO0UdGBXIsoNL3WTZwZSQ1R9ajbigHSiNsSatukNoA5y/H/4GD7cC6dKnGupyMEAgYVddtNBRBKN5tAK7E6mf6TC/5zWB2PDpFwNX8lddddWUqGY7TcRmdQgHGCKptf6/rOJ27L4ggJnde6TqU9kVvcIOeGqo5i191stYZ6FrscdBiq6Ney2cXC2oM5gLnb3kbADLCnnWSzEKzO1kO+qB3PZwIyuAcNYIWRyhMIv0lknUUx2Y4b1YB8m7HeXPRxsy0nUa6YksUbnA+nc8eaZjKG1C5ns2wi4A2IOp3GS0mGnCq8HB8q35R3buxgdI+zpEPXQtA8xu7ro93TqsNe8jGKvdMoxbMOH/Vi8Gr3MB7KNpevgzQ+lced3sCl+grbtpL7jAPoT8RoYepWseG49vGK2NaaDyDJIJtwR2Obwfrp1xNsUZS1S+DgoOvhpCLoxA3RX2FHkeMqjCDGPp0rnhEVan+bj6OwuD1iWC4afe3ak9tjNDWxsZU54HjYD8MTG0t8OjSZc+ffzgF3UFvgv9ATZfXErkFoiodJ1OnDRIXmHFRlCe2TRbZSm3QuIRc3GGOBfL22h5r9VomM8Ke/1yEkrrbIXWJ5tBdPSe1GIENgtcBIhP4sN/5IFVpwSF8Uyp77325iptTSuVX8lH/KR9Z0/KmolQiphiHDVpDGEQeDNqhpvFurwSHTZU2IDSkIRFgRPFa8NMW4Mu6dFVyRR11zfZkeH1hwzbrUffZe1mCxN4QUoGqdvauPXCLUNgYPxPBEFzuYcykK7IB/Aby++nagx77uKN6HOcCPlCGRdMNTMJgFSBvBMWi9QGfqakBdImsw3lre5YEcVKTCUIdNj11SCRuSMrTLonkvu6KXtJ8aO+6Xeg7Zd73BUL+30KUj65sn89abQ0opJMyqZ+HaDlFjC923TzWpZHNArVepSUu4Cvm65Gu2yFhqopOKzYHvn+hfCaj9WcNL5NKJjnry6cjbfjJiv8wzfNldH2JSUMvosPh8sPMAM0bZYIgcxfmyLUTBC2t+bqaaNsh67Gw7fDmCKRtzoq4zSs9tbNLpQ2sfIpsgkNqG97c5i+jou/in5A3R7//+ojuV9MP3q/T6WO6BsklZUBbUk5Jj4CXoZyYjG3l7PY1eGEKkoRsK0kdi0a7jB9HVQmt5gobUg8xAjpBAPIvwZ9PZxKUr7MncKyXjuiJoVpBOkHgOF0YwCn2sVCpJQqesdvTzO348sUqJoe9nF46xGMIcvA1JPfIRwy8+pdvkBEEPcRfb4gZXzWXQJGCKiZAeDnItwe+t8SjctT+XUTKJEl4Sdi3p014SUxa7k8VsylsZLA7tYIlqHXyK+xAXSbZgp0uUz9I2vauUzVYWptsquZgqMlsZ0KGVjlWyspQk+GOFA374VcjT0NTuqWSNlib+Gxnbtg9Q1pI49Bq25fP5VCzpbcldrDIrHrU1jJ8SoZutbbaVcz3sHup25n8wVoT1ImjubsJKsTTtMikUk6IMiR2JIiw1n8qZonY3X+2p4ywNi/XyBuxe+otlUTCWq+pHYN1d/+pFou1MaM2cksUkbSaZqJd1lYb13LaicbMS+eeKCKzKw2FHXQ1clHsAlsmLYUl8JVzU+zCXiJNhTW9l08AsVvj5dJWvAzoW9JYWCJQK5fFLiYl01rYolA6t8VO3FvSXDQG20auiyJCNtNeWCRtexfVKA1GC7xsbU0apcVogZdVq8RGmozmHG3kyihk1yhtRmNednJnFBFrlEbDNi9bA61JWg3bnKwOsoZpNhpza5hro4hSnbQbjXk0y71RRKNeGo7GROrk4iiCXy0th0XYDU3TCmk6XgTolrVdLwHGDg4V0ni8VCotNcy+cnsUsW47zUfzHWD1XB9FPEul/WgMtnLuj3JQt6YBsQm6XC6QCqA3pQVJQG9ZkaVJg/Nu0LrDggGZ0VSAVu0MZ+K0ZoK03rgBDhxnBBlcImHcAEwlfD1GWT6M6r9PbvpDpTIBsc+P/nr09NkJT04+oAsk3MU3tLqDfoj4q2v1cuXz0zv9w2vwF+BhV7xyCADgEkGOrqfK1dO7wUv0WeAl4gIug1cooO7i8xcklKC8HPAX4BytFXeOXr9+m0g2sXwE4jVlZwVI6Q557ZCjt0fGnkhoCxaWy94yRnPkYfEOPSEVBwGMw1zOFu2eBKf+xs5VKeiJqbCwpxU14NO7odRUPTLf0ArcYfSIvH1w0nEcvqEND/D+6/8PAAD//3l5HscwxQIA")))
    LET MD(DescriptionFilter, RootFilter, CategoryFilter, CategoryExcludedFilter) = SELECT * FROM _MD
     WHERE Description =~ DescriptionFilter
       AND Root =~ RootFilter
       AND Category =~ CategoryFilter
       AND NOT Category =~ CategoryExcludedFilter

sources:
- name: Remapping
  query: |
    SELECT * FROM RemapRules

- name: Rules
  query: |
    LET AllRules <=
      SELECT * FROM MD(DescriptionFilter=DescriptionFilter, RootFilter=RootFilter,
        CategoryFilter=CategoryFilter, CategoryExcludedFilter=CategoryExcludedFilter)
    SELECT * FROM AllRules

- name: Globs
  query: |
    LET AllGlobs <=
      SELECT Root, enumerate(items=Glob) AS Globs
      FROM AllRules
      GROUP BY Root

    SELECT * FROM AllGlobs

- query: |
    LET GlobsMD <= to_dict(item={
      SELECT Root AS _key, Globs AS _value FROM AllGlobs
    })

    LET s = scope()

    LET Cache <= memoize(query={
       SELECT Glob, Category, Description, s.Details AS Details, s.Comment AS Comment, s.Filter AS Filter
       FROM AllRules
    }, key="Glob", period=100000)

    LET _ <= remap(config=dict(remappings=RemapRules))

    LET Result = SELECT OSPath, Mtime,
       Data.value AS Data,
       get(item=Cache, field=Globs[0]) AS Metadata,
       Globs[0] AS _Glob,
       IsDir
    FROM foreach(row={
       SELECT _key AS Root, _value AS GlobsToSearch
       FROM items(item=GlobsMD)
       WHERE Root =~ RootFilter
         AND log(message="Will search with globs %v at Root point %v",
             dedup=-1, args=[GlobsToSearch, Root])

    }, query={
       SELECT * FROM glob(globs=GlobsToSearch, root=Root, accessor="registry")
    }, workers=20)

    SELECT Metadata.Description AS Description,
           Metadata.Category AS Category,
           OSPath, Mtime, Data AS _RawData,
           eval(func=Metadata.Details || "x=>x.Data") || Data AS Details,
           Metadata AS _Metadata
    FROM Result
    WHERE eval(func=Metadata.Filter || "x=>NOT IsDir")
      AND Category =~ CategoryFilter
      AND Metadata.Description =~ DescriptionFilter
